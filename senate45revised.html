        <link type="text/css" rel="stylesheet" href="/static/css/style.css">
    	<div class="container">

    		<div class="col-xs-12 col-md-8">
	    		<section id="pan-when-zoomed">
			      	<div id="img_container">
				      	<div class="parent" style="overflow: hidden; position: relative;">
							<div class="panzoom" style="transform: matrix(1, 0, 0, 1, 0, 0); transform-origin: 50% 50% 0px; cursor: move; transition: none;">
								<img src="/static/img/loading.gif">
			          		</div>
		          		</div>
	        		</div>
          			<div role="group" class="btn-group">
				        <button type="button" class="btn btn-link zoom-in"><i class="fa fa-plus" aria-hidden="true"></i></button>
				        <button type="button" class="btn btn-link zoom-out"><i class="fa fa-minus" aria-hidden="true"></i></button>
				        <button type="button" class="btn btn-link reset"><i class="fa fa-undo" aria-hidden="true"></i></button>
			      	</div>
			    </section>
    		</div>

    		<div class="col-xs-12 col-md-4 form">

    		    <div id="loading">
    				<h5>Loading first page...</h5>
    			</div>
    			
    			<div id="firstup" class="alert alert-danger">
				  	<button class="close" data-dismiss="alert" aria-label="close">&times;</button>
					<h3>Welcome to the BURN</h3>
	    			<h5>The document in the box is one page of the Federal Register of Interests for Senators in the current Parliament.<br><br>Move the page around, zoom in or press <i class="fa fa-undo" aria-hidden="true"></i> to reset changes if the scrolling gets wacky. <br><br>When you are ready to help bring this bad boy of a register into the 21st century, dismiss this message with the little &times; above and get on with it. </h5>
				</div>
    			
    			<div id="qs" >
					<div id="ad" class='question'>
							<p>Is the entry an addition or deletion?</p>
							<div class="btn-group" role="group">
								<button value="Addition" class="btn btn-warning">Addition</button>
								<button value="Deletion" class="btn btn-warning">Deletion</button>
							</div>
					</div>

					<div id="who" class='question'>
						<p>Who is the entry for?</p>
						<div class="btn-group-vertical" role="group">
							<button value="Self" class="btn btn-info">Self</button>
							<button value="Spouse" class="btn btn-info">Spouse</button>
							<button value="Self and spouse" class="btn btn-info">Self and spouse</button>
							<button value="Other" class="btn btn-info">Other dependent</button>
						</div>			
					</div>

					<div id="item" class='question'>
						<p>What category or item is the entry?</p>
						<div style="font-size: 0">
							<div class="btn-group-vertical btn-group" role="group">
								<button class="btn btn-xs btn-primary" value='Shareholding'><small>1 Shareholding</small></button>
								<button class="btn btn-xs btn-primary" value='Trust beneficiary'><small>2i Trust <br>beneficiary</small></button>
								<button class="btn btn-xs btn-primary" value='Trustee'><small>2ii Trustee</small></button>
								<button class="btn btn-xs btn-primary" value='Real estate'><small>3 Real estate</small></button>
								<button class="btn btn-xs btn-primary" value='Directorship'><small>4 Directorship</small></button>
								<button class="btn btn-xs btn-primary" value='Partnership'><small>5 Partnership</small></button>
								<button class="btn btn-xs btn-primary" value='Liability'><small>6 Liability</small></button>
								<button class="btn btn-xs btn-primary" value='Bonds/debenture'><small>7 Bond or <br>debenture</small></button>
							</div>
							<div class="btn-group-vertical btn-group" role="group">
								<button class="btn btn-xs btn-primary" value='Savings/other accounts'><small>8 Savings/other<br> account</small></button>
								<button class="btn btn-xs btn-primary" value='Other asset'><small>9 Other asset</small></button>
								<button class="btn btn-xs btn-primary" value='Other income'><small>10 Other income</small></button>
								<button class="btn btn-xs btn-primary" value='Gift'><small>11 Gift</small></button>
								<button class="btn btn-xs btn-primary" value='Travel or hospitality'><small>12 Travel or <br>hospitality</small></button>
								<button class="btn btn-xs btn-primary" value='Membership'><small>13 Membership</small></button>
								<button class="btn btn-xs btn-primary" value='Other conflict'><small>14 Other conflict</small></button>
								<button class="btn btn-primary" value='Not listed'><strong>Not listed</strong></button>	
							</div>
						</div>
					</div>

					<div id="text">
						<textarea class='textarea' style="width:80%;resize:none;"></textarea>
						<button class='btn btn-default'>Create entry</button>
					</div>
				</div>


				
				<div id="entrylist">
				<table class="table">
					<thead>
						<th id="#first"></th>
						<th>Entries</th>
						<th colspan="2"><button id="entry" class='btn btn-default pull-right'>Add entry</button></th>
											
					</thead>
				    <tbody>
				    	<tr>
					    	<td></td>
				    		<td id="noma" colspan="3"></td>
				    	</tr>
				    </tbody>
				</table>

				<div id="perm">
					<button id="prob" class="btn btn-sm btn-danger">Can't read page</button> <button id="save" class="btn btn-sm btn-success">FINISHED!</button>
					<p><span id="i18n_working_task">You are working on page</span> <span id="task-id" class="label label-warning">#</span> of the project</p>
   				    <p><span id="i18n_tasks_completed">You have completed</span> <span id="done" class="label label-info"></span> <span id="i18n_tasks_from">out of </span>
					<span id="total" class="label label-info"></span> pages</p>
			        <div class="progress progress-striped">
			            <div id="progress" rel="tooltip" title="#" class="progress-bar" style="width: 0%;"  role="progressbar">Progress</div>
			        	</div>
					</div>
				</div>

	    </div>

        <script src="/static/js/panzoom.js"></script>    
        <script src="/static/js/picker.js"></script>     
        <script src="/static/js/picker.date.js"></script>
		<script src="/static/js/moment-with-locales.min.js"></script>
		<script src="/static/js/jquery.mobile-events.min.js"></script>
		<script src="/static/js/pybossa/pybossa.js"></script>
		<script> // this script creates the options of names to search through from the below array
		var sen45 = {"gallagherk":"Katy Gallagher","seseljaz":"Zed Seselja","paynem":"Marise Payne","dastyaris":"Sam Dastyari","sinodinosa":"Arthur Sinodinos","mcallisterj":"Jenny Mcallister","nashf":"Fiona Nash","oneilld":"Deborah O\'Neill","fierravantiwellsc":"Concetta Fierravanti-Wells","camerond":"Doug Cameron","rhiannonl":"Lee Rhiannon","williamsj":"John Williams","burstonb":"Brian Burston","leyonhjelmd":"David Leyonhjelm","mccarthym":"Malarndirri Mccarthy","scullionn":"Nigel Scullion","brandisg":"George Brandis","wattm":"Murray Watt","hansonp":"Pauline Hanson","canavanm":"Matthew Canavan","chisholma":"Anthony Chisholm","mcgrathj":"James Mcgrath","moorec":"Claire Moore","macdonaldi":"Ian Macdonald","watersl":"Larissa Waters","osullivanb":"Barry O\'Sullivan","ketterc":"Chris Ketter","robertsm":"Malcolm Roberts","birminghams":"Simon Birmingham","wongp":"Penny Wong","xenophonn":"Nick Xenophon","bernardic":"Cory Bernardi","farrelld":"Don Farrell","griffs":"Stirling Griff","rustona":"Anne Ruston","gallachera":"Alex Gallacher","fawcettd":"David Fawcett","kakoschkemoores":"Skye Kakoschke-Moore","hansonyoungs":"Sarah Hanson-Young","dayb":"Bob Day","abetze":"Eric Abetz","urquharta":"Anne Urquhart","whishwilsonp":"Peter Whish-Wilson","lambiej":"Jacqui Lambie","parrys":"Stephen Parry","polleyh":"Helen Polley","duniamj":"Jonathon Duniam","brownc":"Carol Brown","bushbyd":"David Bushby","singhl":"Lisa Singh","bilykc":"Catryna Bilyk","mckimn":"Nick Mckim","fifieldm":"Mitch Fifield","carrk":"Kim Carr","dinataler":"Richard Di Natale","mckenzieb":"Bridget Mckenzie","conroys":"Stephen Michael Conroy","ryans":"Scott Ryan","collinsj":"Jacinta Collins","patersonj":"James Paterson","marshallg":"Gavin Marshall","hinchd":"Derryn Hinch","ricej":"Janet Rice","humej":"Jane Hume","cormannm":"Mathias Cormann","liness":"Sue Lines","ludlams":"Scott Ludlam","cashm":"Michaelia Cash","sterleg":"Glenn Sterle","smithd":"Dean Smith","dodsonp":"Patrick Dodson","reynoldsl":"Linda Reynolds","backc":"Chris Back","prattl":"Louise Pratt","culletonr":"Rodney Norman Culleton","siewertr":"Rachel Siewert"}   

		var page = {}
		var entries = []
		var e = {}

		$( document ).ready(function(){
			/*
		    Panzoom
		    */

		    (function() {
		        var $section = $('#pan-when-zoomed');
		        $section.find('.panzoom').panzoom({
		            $zoomIn: $section.find(".zoom-in"),
		            $zoomOut: $section.find(".zoom-out"),
		            $reset: $section.find(".reset"),
		            minScale: 0.2,
		            maxScale: 5, 
		        });
		    })();


			//initial state
			$('#qs').hide();
			$('#qs').children().hide();

			//new entry button
			$('#entry').click(function() { 
				$('#qs').slideDown(200,function(){
					$('#ad').fadeIn(0,function(){
						$('#ad').siblings().hide()
					})
				});
				e = {};
			});

			//for whether it's an addition or deletion
			$('#ad > div > button').click(function() { 
				$('#ad').fadeOut(200,function() { 
					$('#who').fadeIn(200)
				});
				e['ad'] = $(this).attr("value");
			});

			//for who it is for
			$('#who > div > button').click(function() { 
				$('#who').fadeOut(200,function() { 
					$('#item').fadeIn(200)
				});
				e['who'] = $(this).attr("value");
			});

			//for what category it is
			$('#item > div > div > button').click(function() { 
				$('#item').fadeOut(200,function() { 
					$('#text').fadeIn(200)
				});
				e['item'] = $(this).attr("value");
			});

			//for submit button
			$('#text > button').click(function(){
				$('#text').fadeOut(0,function(){
					togqs();
				});
				var clear = function(html) {
			        return $( $.parseHTML(html) ).text();
			    };
				e['text'] = clear($('.textarea').val());
				$('.textarea').val('');
				entries.push(e);
				$('#first').val('');
				lister();
			})

			//for copy button
			$('table').on('click','.copy',function(){
				e = {};
				var copied = entries[$(this).attr("value")];
				e['ad'] = copied['ad'];
				e['who'] = copied['who'];
				e['item'] = copied['item'];
				e['text'] = copied['text'];
				$('.textarea').val(copied['text']);
				$('#qs').slideDown(200,function(){$('#text').siblings().hide(0,function(){$('#text').fadeIn(200)})});
			})

			//for delete button
			$('table').on('click','.close',function(){
				console.log(entries);
				console.log($(this).attr("value"));
				entries.splice($(this).attr("value"), 1);
				lister();
				console.log(entries);
			})


			var togqs = function() {
				$('#qs').slideToggle()
			}

			var lister = function() {
				var table = ''
				for (entry in entries) {
					table = table + 			`<tr> \
				        <td rowspan='2'>&#x25cf;</td> \
				        <td colspan='3' style="text-align: left;"><button value=${entry} class='close' data-dismiss='alert' aria-label='close'>&nbsp;&nbsp;&times;&nbsp;&nbsp;</button><button value=${entry} class='btn btn-xs btn-default copy pull-right'>Copy</button>${entries[entry]['text']} \
				        </td> \
				    </tr> \
				    <tr> \
				    	<td><small>${entries[entry]['ad']}</small></td> \
				        <td><small>${entries[entry]['item']}</small></td> \
					    <td><small>${entries[entry]['who']}</small></td> \
					     \
					</tr>`
				}
				$('tbody').html(table);

			}

			function loadUserProgress() {
			    pybossa.userProgress('coalitionsenators-initial').done(function(data){
			        var pct = Math.round((data.done*100)/data.total);
			        $("#progress").css("width", pct.toString() +"%");
			        $("#progress").attr("title", pct.toString() + "% completed!");
			        $("#progress").tooltip({'placement': 'left'}); 
			        $("#total").text(data.total);
			        $("#done").text(data.done);
			    });
			}

			pybossa.taskLoaded(function(task, deferred) {
						    if ( !$.isEmptyObject(task) ) {
						        var img = $('<img />');
						        img.load(function() {
						            // continue as soon as the image is loaded
						            deferred.resolve(task);
						        });
						        img.attr('src', task.info.url_b);
						        img.addClass('img-responsive');
						        task.info.image = img;
						    } else {
						        deferred.resolve(task);
						    }
						});

			pybossa.presentTask(function(task, deferred) {
			    if ( !$.isEmptyObject(task) ) {
    				loadUserProgress();
    				$('#task-id').html(task.id);
    				// this is fpr the basic info about the page. Whether it has a name, what the name is, 
					// whether it has a date, what the date is, and how many entries on are the form
			    	page = {
					    name : task.info.title.split("_")[0],
					    date : task.info.title.split("_")[1],
					    number : task.info.title.split("_")[2],
					    problem: false,
					};
					entries = [];
			        // load image from flickr
			        $('#loading').hide(0);
			        $('tbody').html("<tr>\
					    	<td></td>\
				    		<td colspan='3'>You don't have any entries here! (yet...?) If there are no entries listed on the page, hit that green button below.<br><br>And if it wasn't already obvious, this page belongs to <strong>"+sen45[task.info.title.split("_")[0]]+"</strong>.</td>\
				    		</tr>");
	    			$('.panzoom').html('').append(task.info.image);
	    			$('.panzoom').panzoom("reset");

	    			//for save
				    $('#save').off('click').on('click', function(evt) {
			            var answer = [page,entries];
			            pybossa.saveTask(task.id, answer).done(function() {
			            	deferred.resolve();
			            });
			            $('qs').hide();

			        });

			        //for illegible button
					$('#prob').off('click').on('click',function(evt){
						page['problem'] = true;
						var answer = [page,entries];
			            pybossa.saveTask(task.id, answer).done(function() {
			            	deferred.resolve();
			            });
			            $('qs').hide();
					})
			    
			    } else {
			        $("#end").html("<h2>Yahoo! That was the last page you had left to do. Thanks for being part of the BURN.</h2>")
			    }
			});
			pybossa.run('coalitionsenators-initial');
		});
	  </script>
